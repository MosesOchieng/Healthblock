<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="./style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.3.5/web3.min.js"></script>
<style>
/* Global Variables */
:root {
    --color1: #eee;
    --color2: #fff;
    --color3: #00cc0e;
    --color3Hover: #008e09;
    --color4: #00dbff;
    --color4Hover: #0099b2;
    --color5: #b12bff;
    --color5Hover: #8300d0;
    --color6: #2c3233;
    --color7: #a2b1ba;
}
#daoPopup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px;
    background-color: #f9f9f9;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
}

/* Style for the DAO information display */
#daoInfo {
    margin-top: 20px;
    padding: 20px;
    background-color: #f9f9f9;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
}
/* Reset Default Settings */
* {
    box-sizing: border-box;
    margin: 0;
}
    /* Style for individual DAO info cards */
    .daoCard {
        flex: 1;
        margin-right: 20px;
        padding: 10px;
        background-color: white;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

.container1 {
    /* Flex */
    display: flex;
    justify-content: center;
    align-items: center;
}

.container__card {
    background-color: var(--color2);
    width: 320px;
    height: 520px;
    text-align: center;
    transition: transform 0.3s;

    /* Flex */
    display: flex;
    flex-direction: column;
    align-items: center;
}

.container__card:not(.container__card:last-of-type) {
    margin-right: 35px;
}

.container__card:hover {
    transform: translateY(-15px);
}

.container__cardSvgs {
    width: 100%;
    height: 240px;
    position: relative;

    /* Flex */
    display: flex;
    justify-content: center;
    align-items: center;
}

.container__cardSvg1 {
    /* Position */
    position: absolute;
    left: 41px;
    bottom: 38px;
}

.container__cardSvg2 {
    /* Position */
    position: absolute;
    right: 36px;
    top: 40px;
}

.container__cardSvg3 {
    position: absolute;
}

.container__cardContent {
    padding: 35px;
}

.container__cardName {
    color: var(--color6);
    font-size: 17px;
    letter-spacing: 1px;
}

.container__cardPrice {
    color: var(--color4);
    margin: 20px 0;
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 1px;
}

.container__cardDesc {
    color: var(--color7);
    padding: 0 30px;
    margin-bottom: 40px;
    font-size: 12px;
    letter-spacing: 1px;
    line-height: 1.6;
}

.container__cardLink {
    color: var(--color2);
    padding: 10px 20px;
    font-size: 12px;
    font-weight: 700;

    /* Text */
    text-decoration: none;
    letter-spacing: 2px;
}

.container__cardLink:hover {
    background-color: var(--color3Hover) !important;
}

.container__card:nth-of-type(2) .container__cardLink:hover {
    background-color: var(--color4Hover) !important;
}

.container__card:nth-of-type(3) .container__cardLink:hover {
    background-color: var(--color5Hover) !important;
}
    .container {
        width: 60%;
        max-width: 200px;
    }
    
    .modal-overlay {
        display: none;
        position: fixed; /* Use fixed positioning to cover the entire viewport */
        top: 300px;
        left: 800px;
        width: 100%;
        height: 100%;
       
        align-items: center;
        justify-content: center;
        z-index: 1000;
    }
    
    .modal-content {
        background-color: white;
        border-radius: 5px;
        padding: 20px;
        box-shadow: none; /* Remove the shadow */
        position: relative;
        width: 100%;
        max-width: 350px;
        z-index: 1001; /* Place the content above the overlay */
    }
    
    /* Centered content */
    .modal-content h2,
    .modal-content label,
    .modal-content input,
    .modal-content button,
    .modal-content p {
        text-align: center;
    }
    
    input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    
    #creditResult {
        font-weight: bold;
        margin-top: 10px;
    }
    
    .popup1 {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #ffffff;
        border: 1px solid #ccc;
        padding: 20px;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        z-index: 9999;
    } 
</style>

</head>
<body>
<!-- partial:index.partial.html -->
<!-- Banner -->

</a>

<!-- Dashboard -->
<div class="d-flex flex-column flex-lg-row h-lg-full bg-surface-secondary">
    <!-- Vertical Navbar -->
    <nav class="navbar show navbar-vertical h-lg-screen navbar-expand-lg px-0 py-3 navbar-light bg-white border-bottom border-bottom-lg-0 border-end-lg" id="navbarVertical">
        <div class="container-fluid">
            <!-- Toggler -->
            <button class="navbar-toggler ms-n2" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarCollapse" aria-controls="sidebarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Brand -->
            <a class="navbar-brand py-lg-2 mb-lg-5 px-lg-6 me-0" href="#">
                <img src="#" alt="...">
            </a>
            <!-- User menu (mobile) -->
            <div class="navbar-user d-lg-none">
                <!-- Dropdown -->
                <div class="dropdown">
                    <!-- Toggle -->
                    <a href="#" id="sidebarAvatar" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <div class="avatar-parent-child">
                            <img alt="Image Placeholder" src="https://images.unsplash.com/photo-1548142813-c348350df52b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=3&w=256&h=256&q=80" class="avatar avatar- rounded-circle">
                            <span class="avatar-child avatar-badge bg-success"></span>
                        </div>
                    </a>
                    <!-- Menu -->
                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="sidebarAvatar">
                        <a href="#" class="dropdown-item">Profile</a>
                        <a href="#" class="dropdown-item">Settings</a>
                        <a href="#" class="dropdown-item">Billing</a>
                        <hr class="dropdown-divider">
                        <a href="#" class="dropdown-item">Logout</a>
                    </div>
                </div>
            </div>
            <!-- Collapse -->
            <div class="collapse navbar-collapse" id="sidebarCollapse">
                <!-- Navigation -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-house"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="showPopup">
                            <i class="bi bi-bar-chart" ></i> Claim Insurance
                        </a>
                    </li>
            
                    <li class="nav-item">
                        <a class="nav-link" href="#" >
                            <i class="bi bi-chat"></i>Fractional Insurance
                            <span class="badge bg-soft-primary text-primary rounded-pill d-inline-flex align-items-center ms-auto">6</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="openCreditPopup">
                            <i class="bi bi-bookmarks"></i> Credit  Update
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="openCheckCreditPopup">
                            <i class="bi bi-bar-chart" ></i> Credit Worth
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="createDAOPopup">
                            <i class="bi bi-people"></i> Community Insurance
                    </li>
               
                </ul>
   

                <!-- Push content down -->
                <div class="mt-auto"></div>
                <!-- User (md) -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-person-square"></i> Account
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-box-arrow-left"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Main content -->
    <div class="h-screen flex-grow-1 overflow-y-lg-auto">
        <!-- Header -->
        <header class="bg-surface-primary border-bottom pt-6">
            <div class="container-fluid">
                <div class="mb-npx">
                    <div class="row align-items-center">
                        <div class="col-sm-6 col-12 mb-4 mb-sm-0">
                            <!-- Title -->
                            <h1 class="h2 mb-0 ls-tight">Health Chain</h1>
                        </div>
                        <!-- Actions -->
                        <div class="col-sm-6 col-12 text-sm-end">
                            <div class="mx-n1">
                                <a href="#" class="btn d-inline-flex btn-sm btn-neutral border-base mx-1">
                                    <span class=" pe-2">
                                        <i class="bi bi-plus"></i>
                                    </span>
                                    <span>Payments</span>
                                </a>
                                <a href="#" class="btn d-inline-flex btn-sm btn-primary mx-1">
                                    <span class=" pe-2">
                                        <i class="bi bi-plus"></i>
                                    </span>
                                    <span>Stake .</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <!-- Nav -->
                    <ul class="nav nav-tabs mt-4 overflow-x border-0">
                        <li class="nav-item ">
                            <a href="#" class="nav-link active">Home</a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link font-regular">Premiums</a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link font-regular">Updates</a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <!-- Main -->
        <main class="py-6 bg-surface-secondary">
            <div class="container-fluid">
                <!-- Card stats -->
                <div class="row g-6 mb-6">
                    <div class="col-xl-3 col-sm-6 col-12">
                        <div class="card shadow border-0">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <span class="h6 font-semibold text-muted text-sm d-block mb-2">Fractional Insurance</span>
                                        <span class="h3 font-bold mb-0" id="result"></span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape bg-tertiary text-white text-lg rounded-circle">
                                            <i class="bi bi-credit-card"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm">
                                    <span class="badge badge-pill bg-soft-success text-success me-2">
                                        <i class="bi bi-arrow-up me-1"></i>13%
                                    </span>
                                    <span class="text-nowrap text-xs text-muted">Since last month</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-sm-6 col-12">
                        <div class="card shadow border-0">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <span class="h6 font-semibold text-muted text-sm d-block mb-2">Premium Packages </span>
                                        <span class="h3 font-bold mb-0"  id="packages"></span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape bg-primary text-white text-lg rounded-circle">
                                            <i class="bi bi-people"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm">
                                    <span class="badge badge-pill bg-soft-success text-success me-2">
                                        <i class="bi bi-arrow-up me-1"></i>30%
                                    </span>
                                    <span class="text-nowrap text-xs text-muted">Since last month</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-sm-6 col-12">
                        <div class="card shadow border-0">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <span class="h6 font-semibold text-muted text-sm d-block mb-2">Credit Score Display</span>
                                        <span class="h3 font-bold mb-0" id="creditScoreDisplay"></span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape bg-info text-white text-lg rounded-circle">
                                            <i class="bi bi-clock-history"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm">
                                    <span class="badge badge-pill bg-soft-danger text-danger me-2">
                                        <i class="bi bi-arrow-down me-1"></i>-5%
                                    </span>
                                    <span class="text-nowrap text-xs text-muted">Since last month</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-sm-6 col-12">
                        <div class="card shadow border-0">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col">
                                        <span class="h6 font-semibold text-muted text-sm d-block mb-2">Claim Insurance</span>
                                        <span class="h3 font-bold mb-0" id="claimedAmount"></span>
                                    </div>
                                    <div class="col-auto">
                                        <div class="icon icon-shape bg-warning text-white text-lg rounded-circle">
                                            <i class="bi bi-minecart-loaded" id="claimStatus"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 mb-0 text-sm">
                                    <span class="badge badge-pill bg-soft-success text-success me-2">
                                        <i class="bi bi-arrow-up me-1"></i>10%
                                    </span>
                                    <span class="text-nowrap text-xs text-muted">Since last month</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <section>
                    <div id="daoInfo">
                        <h2>Created DAO Information</h2>
                        <p><strong>DAO Name:</strong> <span id="daoNameInfo"></span></p>
                        <p><strong>Premium Amount:</strong> <span id="premiumAmountInfo"></span></p>
                        <p><strong>Claim Threshold:</strong> <span id="claimThresholdInfo"></span></p>
                    </div>
                </section>
           
                    <div class="card-footer border-0 py-5">
                        <span class="text-muted text-sm">Showing 10 items out of 30 results found</span>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<script src="app.js"></script>

    <section>
        <section>
            <div class="modal-overlay" id="creditPopup">
                <!-- ... (your modal content for updating credit score) -->
                <div class="modal-content">
                    <h2>Update Credit Score</h2>
                    <label for="userAddress">User Address:</label>
                    <br>
                    <input type="text" id="userAddress" required><br>
                    <label for="newCreditScore">New Credit Score:</label>
                    <br>
                    <input type="number" id="newCreditScore" min="0" required><br>
                    <br>
                    <br>
                    <button id="updateCreditButton">Update Credit Score</button>
                </div>
            </div>
            <div class="modal-overlay" id="creditCheckPopup">
                <!-- ... (your modal content for checking creditworthiness) -->
                <div class="modal-content">
                    <h2>Check Creditworthiness</h2>
                    <label for="checkUserAddress">User Address:</label>
                    <input type="text" id="checkUserAddress" required><br>
                    <button id="checkCreditButton">Check Creditworthiness</button>
                    <p id="creditResult"></p>
                </div>
            </div>
          
        </section>
        <script>
            document.addEventListener("DOMContentLoaded", async () => {
                if (window.ethereum) {
                    window.web3 = new Web3(ethereum);
                    try {
                        await ethereum.enable();
                        initContract();
                    } catch (error) {
                        console.error("User denied account access");
                    }
                } else if (window.web3) {
                    window.web3 = new Web3(web3.currentProvider);
                    initContract();
                } else {
                    console.error("No Ethereum browser extension detected");
                }
            });
        // ABI array for the smart contract
        const ABI = [
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "user",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "creditScore",
                        "type": "uint256"
                    }
                ],
                "name": "CreditScoreUpdated",
                "type": "event"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "user",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "newCreditScore",
                        "type": "uint256"
                    }
                ],
                "name": "updateCreditScore",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "user",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "requestedAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "income",
                        "type": "uint256"
                    },
                    {
                        "internalType": "bool",
                        "name": "hasSteadyEmployment",
                        "type": "bool"
                    }
                ],
                "name": "accessCredit",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "name": "creditScores",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            }
        ];
        
        // Replace with the actual address of your deployed contract
        const contractAddress = "0xd9145CCE52D386f254917e481eB44e9943F39138";
        
        document.addEventListener("DOMContentLoaded", async () => {
            if (window.ethereum) {
                window.web3 = new Web3(ethereum);
                try {
                    await ethereum.enable();
                    initContract();
                } catch (error) {
                    console.error("User denied account access");
                }
            } else if (window.web3) {
                window.web3 = new Web3(web3.currentProvider);
                initContract();
            } else {
                console.error("No Ethereum browser extension detected");
            }
        });
        
        async function initContract() {
            window.insuranceContract = new web3.eth.Contract(ABI, contractAddress);
        }
        
        const openCreditPopupButton = document.getElementById("openCreditPopup");
        const creditPopup = document.getElementById("creditPopup");
        const updateCreditButton = document.getElementById("updateCreditButton");
        const userAddressInput = document.getElementById("userAddress");
        const newCreditScoreInput = document.getElementById("newCreditScore");
        
        const openCheckCreditPopupButton = document.getElementById("openCheckCreditPopup");
        const creditCheckPopup = document.getElementById("creditCheckPopup");
        const checkCreditButton = document.getElementById("checkCreditButton");
        const checkUserAddressInput = document.getElementById("checkUserAddress");
        const creditResult = document.getElementById("creditResult");
        
        openCreditPopupButton.addEventListener("click", () => {
            creditPopup.style.display = "block";
        });
        
        updateCreditButton.addEventListener("click", async () => {
            const userAddress = userAddressInput.value;
            const newCreditScore = newCreditScoreInput.value;
        
            // Implement contract interaction to update credit score
            try {
                const accounts = await web3.eth.getAccounts();
                const contract = new web3.eth.Contract(ABI, contractAddress);
                await contract.methods.updateCreditScore(userAddress, newCreditScore).send({ from: accounts[0] });
        
                creditPopup.style.display = "none";
                userAddressInput.value = "";
                newCreditScoreInput.value = "";
            } catch (error) {
                console.error("Error updating credit score:", error);
            }
        });
        
        openCheckCreditPopupButton.addEventListener("click", () => {
            creditCheckPopup.style.display = "block";
            creditResult.textContent = "";
        });
        
        checkCreditButton.addEventListener("click", async () => {
            const checkUserAddress = checkUserAddressInput.value;
            const requestedAmount = 1000; // Replace with the actual requested amount
            const income = 50000; // Replace with the actual user's income
            const hasSteadyEmployment = true; // Replace with the actual user's employment status
        
            // Implement contract interaction to check creditworthiness
            try {
                const contract = new web3.eth.Contract(ABI, contractAddress);
                const isCreditworthy = await contract.methods.accessCredit(checkUserAddress, requestedAmount, income, hasSteadyEmployment).call();
        
                if (isCreditworthy) {
                    creditResult.textContent = "Creditworthy!";
                    creditResult.style.color = "green";
                } else {
                    creditResult.textContent = "Not creditworthy.";
                    creditResult.style.color = "red";
                }
            } catch (error) {
                console.error("Error checking creditworthiness:", error);
            }
        });
    </script>        
        
    </section>
<section>
    <div class="popup1" id="claimPopup" style="display: none;">
        <h2>Claim Submission</h2>
        <label for="claimAmount">Claim Amount:</label>
        <input type="number" id="claimAmount" step="0.01" placeholder="Enter claim amount">
        <button id="submitClaim">Submit</button>
    </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
        if (window.ethereum) {
            window.web3 = new Web3(ethereum);
            try {
                await ethereum.request({ method: 'eth_requestAccounts' });
                initContracts();
            } catch (error) {
                console.error("User denied account access");
            }
        } else if (window.web3) {
            window.web3 = new Web3(web3.currentProvider);
            initContracts();
        } else {
            console.error("No Ethereum browser extension detected");
        }
    });
    
    async function initContracts() {
        try {
            const claimsContractAddress = "0xd8b934580fcE35a11B58C6D73aDeE468a2833fa8"; // Replace with your contract address
            const claimsContractAbi = [
                // ... Your ClaimsProcessingContract ABI ...
                [
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "user",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "payoutAmount",
				"type": "uint256"
			}
		],
		"name": "ClaimProcessed",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_user",
				"type": "address"
			}
		],
		"name": "getClaimedAmount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_user",
				"type": "address"
			}
		],
		"name": "getInsurancePolicy",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "policyAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "policyCoverage",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "insuranceClaimAmount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "insurancePolicyAmount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "insurancePolicyCoverage",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_user",
				"type": "address"
			}
		],
		"name": "isClaimPending",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "isClaimValid",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_user",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "_policyAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_policyCoverage",
				"type": "uint256"
			}
		],
		"name": "setInsurancePolicy",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_claimAmount",
				"type": "uint256"
			}
		],
		"name": "submitClaim",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
]
            ];
    
            window.claimsContract = new web3.eth.Contract(claimsContractAbi, claimsContractAddress);
    
            setupClaimSubmission();
            displayClaimDetails(); // Fetch and display claim details
        } catch (error) {
            console.error("Error initializing contracts:", error);
        }
    }
    
    function setupClaimSubmission() {
        const showPopupButton = document.getElementById("showPopup");
        const claimPopup = document.getElementById("claimPopup");
        const submitClaimButton = document.getElementById("submitClaim");
        const claimAmountInput = document.getElementById("claimAmount");
    
        showPopupButton.addEventListener("click", () => {
            claimPopup.style.display = "block";
        });
    
        submitClaimButton.addEventListener("click", async () => {
            try {
                const accounts = await web3.eth.getAccounts();
                const claimAmount = web3.utils.toWei(claimAmountInput.value, "ether");
    
                await claimsContract.methods.submitClaim(claimAmount).send({
                    from: accounts[0]
                });
    
                alert("Claim submitted successfully. Your claim will be reviewed.");
                claimPopup.style.display = "none";
                claimAmountInput.value = "";
    
                displayClaimDetails(); // Update claim details after submission
            } catch (error) {
                console.error("Error submitting claim:", error);
            }
        });
    }
    
    async function displayClaimDetails() {
        const accounts = await web3.eth.getAccounts();
        const user = accounts[0];
    
        const claimedAmount = await claimsContract.methods.getClaimedAmount(user).call();
        const isClaimPending = await claimsContract.methods.isClaimPending(user).call();
    
        document.getElementById("claimedAmount").textContent = web3.utils.fromWei(claimedAmount, "ether") + " Ether";
        document.getElementById("claimStatus").textContent = isClaimPending ? "Pending" : "Active";
    }
    
  </script>
 </section>
 <section>
    <div id="daoInfo">
        <div class="daoCard">
            <h2>Created DAO </h2>
            <p><strong>DAO Name:</strong> <span id="daoNameInfo"></span></p>
        </div>
        <div class="daoCard">
            <p><strong>Premium Amount:</strong> <span id="premiumAmountInfo"></span></p>
        </div>
        <div class="daoCard">
            <p><strong>Claim Threshold:</strong> <span id="claimThresholdInfo"></span></p>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            if (window.ethereum) {
                window.web3 = new Web3(ethereum);
                try {
                    await ethereum.request({ method: 'eth_requestAccounts' });
                    initContracts();
                } catch (error) {
                    console.error("User denied account access");
                }
            } else if (window.web3) {
                window.web3 = new Web3(web3.currentProvider);
                initContracts();
            } else {
                console.error("No Ethereum browser extension detected");
            }
        });
        
        async function initContracts() {
            try {
                const contractAddress = "0xf8e81D47203A594245E36C48e151709F0C19fBe8"; // Replace with your contract address
                const contractAbi = [
                    // ... Your CommunityInsurancePoolContract ABI ...
                    [
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "policyId",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "address[]",
				"name": "participants",
				"type": "address[]"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "premiumAmount",
				"type": "uint256"
			}
		],
		"name": "PolicyCreated",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "policyId",
				"type": "uint256"
			}
		],
		"name": "contributeToPolicy",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address[]",
				"name": "_participants",
				"type": "address[]"
			},
			{
				"internalType": "uint256",
				"name": "_premiumAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_claimThreshold",
				"type": "uint256"
			}
		],
		"name": "createPolicy",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "policyId",
				"type": "uint256"
			}
		],
		"name": "makeClaim",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "policies",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "premiumAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "totalPooledAmount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "claimThreshold",
				"type": "uint256"
			},
			{
				"internalType": "bool",
				"name": "isClaimed",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]
                ];
        
                window.contract = new web3.eth.Contract(contractAbi, contractAddress);
        
                setupCreateDAOPopup();
            } catch (error) {
                console.error("Error initializing contracts:", error);
            }
        }
        
        function setupCreateDAOPopup() {
            const createDAOPopupButton = document.getElementById("createDAOPopup");
            const daoPopup = document.getElementById("daoPopup");
            const daoNameInput = document.getElementById("daoName");
            const premiumAmountInput = document.getElementById("premiumAmount");
            const claimThresholdInput = document.getElementById("claimThreshold");
            const submitDAOButton = document.getElementById("submitDAO");
        
            createDAOPopupButton.addEventListener("click", () => {
                daoPopup.style.display = "block";
            });
        
            submitDAOButton.addEventListener("click", async () => {
                try {
                    const accounts = await web3.eth.getAccounts();
                    const daoName = daoNameInput.value;
                    const premiumAmount = web3.utils.toWei(premiumAmountInput.value, "ether");
                    const claimThreshold = web3.utils.toWei(claimThresholdInput.value, "ether");
        
                    await contract.methods.createPolicy(
                        [accounts[0]], // Participants (initially just the creator)
                        premiumAmount,
                        claimThreshold
                    ).send({
                        from: accounts[0],
                        value: premiumAmount
                    });
        
                    alert("DAO created successfully!");
                    daoPopup.style.display = "none";
                    daoNameInput.value = "";
                    premiumAmountInput.value = "";
                    claimThresholdInput.value = "";
        
                    displayDAOInfo(); // Update DAO information after creation
                } catch (error) {
                    console.error("Error creating DAO:", error);
                }
            });
        }
        
        async function displayDAOInfo() {
            const daoInfoDiv = document.getElementById("daoInfo");
        
            // Fetch DAO information from the smart contract and update the displayed info
            // Example: Get DAO name, premium amount, claim threshold from the contract
            const policyId = 0; // Replace with the actual policy ID
            const policy = await contract.methods.policies(policyId).call();
        
            document.getElementById("daoNameInfo").textContent = policy.participants[0] || "N/A";
            document.getElementById("premiumAmountInfo").textContent = web3.utils.fromWei(policy.premiumAmount, "ether") + " Ether";
            document.getElementById("claimThresholdInfo").textContent = web3.utils.fromWei(policy.claimThreshold, "ether") + " Ether";
        
            daoInfoDiv.style.display = "block"; // Display the updated DAO information
        }
        
    </script>
 </section>
</body>
</html>
